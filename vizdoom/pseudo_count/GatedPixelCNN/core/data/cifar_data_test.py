import cifar_data as cifar
import numpy as np
from data_test_utils import *


np.random.seed(39)
data_dir = "./"
height = 32
width = 32
train_label = 6

print("Testing CIFAR dataset without preprocessing")
dataset = cifar.get_dataset(data_dir)
train_image = np.array([[ 0.36470588,  0.22745098,  0.1254902 ],
 [ 0.70196078,  0.60392157,  0.54117647],
 [ 0.93333333,  0.88627451,  0.83137255],
 [ 0.97254902,  0.95294118,  0.89803922],
 [ 0.66666667,  0.5254902,   0.40784314],
 [ 0.7254902,   0.51764706,  0.34509804],
 [ 0.94509804,  0.83921569,  0.69411765],
 [ 0.90196078,  0.85490196,  0.76470588],
 [ 0.73333333,  0.6627451,   0.55686275],
 [ 0.70588235,  0.62745098,  0.51372549],
 [ 0.65098039,  0.57254902,  0.45098039],
 [ 0.57254902,  0.46666667,  0.33333333],
 [ 0.58431373,  0.45490196,  0.30980392],
 [ 0.61568627,  0.48627451,  0.3254902 ],
 [ 0.72156863,  0.61568627,  0.43137255],
 [ 0.84705882,  0.76470588,  0.55294118]])
test_datasets(dataset, height, width, 3, train_image, train_label)

q_levels = 100
print("Testing CIFAR dataset with 100 Q-Levels preprocessing")
dataset = cifar.get_dataset(data_dir, preprocess(q_levels))
train_image = np.array([[ 0.36470588,  0.22745098,  0.1254902 ],
 [ 0.70196078,  0.60392157,  0.54117647],
 [ 0.93333333,  0.88627451,  0.83137255],
 [ 0.97254902,  0.95294118,  0.89803922],
 [ 0.66666667,  0.5254902,   0.40784314],
 [ 0.7254902,   0.51764706,  0.34509804],
 [ 0.94509804,  0.83921569,  0.69411765],
 [ 0.90196078,  0.85490196,  0.76470588],
 [ 0.73333333,  0.6627451,   0.55686275],
 [ 0.70588235,  0.62745098,  0.51372549],
 [ 0.65098039,  0.57254902,  0.45098039],
 [ 0.57254902,  0.46666667,  0.33333333],
 [ 0.58431373,  0.45490196,  0.30980392],
 [ 0.61568627,  0.48627451,  0.3254902 ],
 [ 0.72156863,  0.61568627,  0.43137255],
 [ 0.84705882,  0.76470588,  0.55294118]])
train_label = np.array([[36, 22, 12],
 [70, 60, 54],
 [93, 88, 83],
 [97, 95, 89],
 [66, 52, 40],
 [72, 51, 34],
 [94, 83, 69],
 [90, 85, 76],
 [73, 66, 55],
 [70, 62, 51],
 [65, 57, 45],
 [57, 46, 33],
 [58, 45, 30],
 [61, 48, 32],
 [72, 61, 43],
 [84, 76, 55]]
)
test_datasets(dataset, height, width, 3, train_image, train_label)

q_levels = 256
print("Testing CIFAR dataset with 256 Q-Levels preprocessing")
dataset = cifar.get_dataset(data_dir, preprocess(q_levels))
train_image = np.array([[ 0.36470588,  0.22745098,  0.1254902 ],
 [ 0.70196078,  0.60392157,  0.54117647],
 [ 0.93333333,  0.88627451,  0.83137255],
 [ 0.97254902,  0.95294118,  0.89803922],
 [ 0.66666667,  0.5254902,   0.40784314],
 [ 0.7254902,   0.51764706,  0.34509804],
 [ 0.94509804,  0.83921569,  0.69411765],
 [ 0.90196078,  0.85490196,  0.76470588],
 [ 0.73333333,  0.6627451,   0.55686275],
 [ 0.70588235,  0.62745098,  0.51372549],
 [ 0.65098039,  0.57254902,  0.45098039],
 [ 0.57254902,  0.46666667,  0.33333333],
 [ 0.58431373,  0.45490196,  0.30980392],
 [ 0.61568627,  0.48627451,  0.3254902 ],
 [ 0.72156863,  0.61568627,  0.43137255],
 [ 0.84705882,  0.76470588,  0.55294118]])
train_label = np.array([[ 93,  58,  32],
 [179, 154, 138],
 [238, 226, 212],
 [248, 243, 229],
 [170, 134, 104],
 [185, 132,  88],
 [241, 214, 177],
 [230, 218, 195],
 [187, 169, 142],
 [180, 160, 131],
 [166, 146, 115],
 [146, 119,  85],
 [149, 116,  79],
 [157, 124,  83],
 [184, 157, 110],
 [216, 195, 141]]
)
test_datasets(dataset, height, width, 3, train_image, train_label)

print("\n----- All tests passed -----")
 